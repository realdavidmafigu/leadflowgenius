(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[138],{500:(e,a,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard/crm/clients/[id]",function(){return t(8513)}])},3455:(e,a,t)=>{"use strict";t.d(a,{A:()=>d});var s=t(7876),l=t(4232),n=t(8230),r=t.n(n),i=t(9099);let o=[{label:"Dashboard Overview",href:"/dashboard/crm"},{label:"Clients",href:"/dashboard/crm/clients"},{label:"Invoices",href:"/dashboard/crm/invoices"},{label:"Products/Services",href:"/dashboard/crm/products"},{label:"Business Profile",href:"/dashboard/crm/profile"},{label:"Payments (Manual)",href:"/dashboard/crm/payments"}];function d(e){let{children:a}=e,t=(0,i.useRouter)(),[n,d]=(0,l.useState)(!1);return(0,s.jsxs)("div",{className:"min-h-screen flex font-sans",children:[(0,s.jsxs)("aside",{className:"hidden md:flex w-64 bg-gradient-to-b from-[#1a1333] via-[#2d1a4d] to-[#6a5cff] text-white/90 p-6 flex-col gap-6 border-r border-white/10 backdrop-blur-xl",children:[(0,s.jsx)("div",{className:"text-2xl font-extrabold bg-gradient-to-r from-[#ff5f8f] to-[#6a5cff] bg-clip-text text-transparent mb-8",children:"Leadflowgenius CRM"}),(0,s.jsx)("nav",{className:"flex flex-col gap-3",children:o.map(e=>(0,s.jsx)(r(),{href:e.href,legacyBehavior:!0,children:(0,s.jsx)("a",{className:"block px-4 py-2 rounded transition-colors ".concat(t.pathname===e.href?"bg-blue-700 font-semibold":"hover:bg-blue-800"),children:e.label})},e.href))})]}),(0,s.jsx)("button",{className:"md:hidden fixed top-4 left-4 z-50 bg-[#1a1333] text-white p-2 rounded shadow-lg focus:outline-none focus:ring-2 focus:ring-white/50","aria-label":"Open navigation menu",onClick:()=>d(!0),children:(0,s.jsx)("svg",{className:"h-7 w-7",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),n&&(0,s.jsxs)("div",{className:"md:hidden fixed inset-0 z-40 flex",children:[(0,s.jsxs)("div",{className:"w-64 bg-gradient-to-b from-[#1a1333] via-[#2d1a4d] to-[#6a5cff] text-white/90 p-6 flex flex-col gap-6 border-r border-white/10 backdrop-blur-xl animate-slide-in-left relative",children:[(0,s.jsx)("button",{className:"absolute top-4 right-4 text-white p-2 rounded focus:outline-none focus:ring-2 focus:ring-white/50","aria-label":"Close navigation menu",onClick:()=>d(!1),children:(0,s.jsx)("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),(0,s.jsx)("div",{className:"text-2xl font-extrabold bg-gradient-to-r from-[#ff5f8f] to-[#6a5cff] bg-clip-text text-transparent mb-8",children:"Leadflowgenius CRM"}),(0,s.jsx)("nav",{className:"flex flex-col gap-3",children:o.map(e=>(0,s.jsx)(r(),{href:e.href,legacyBehavior:!0,children:(0,s.jsx)("a",{className:"block px-4 py-2 rounded transition-colors ".concat(t.pathname===e.href?"bg-blue-700 font-semibold":"hover:bg-blue-800"),onClick:()=>d(!1),children:e.label})},e.href))})]}),(0,s.jsx)("div",{className:"flex-1 bg-black bg-opacity-40",onClick:()=>d(!1)})]}),(0,s.jsx)("main",{className:"flex-1 bg-gradient-to-br from-[#1a1333]/80 via-[#2d1a4d]/80 to-[#ff5f8f]/60 p-6 md:p-12 min-h-screen overflow-y-auto",children:(0,s.jsx)("div",{className:"max-w-6xl mx-auto bg-white/10 backdrop-blur-2xl rounded-2xl shadow-2xl border border-white/10 p-6 md:p-12",children:a})})]})}},8513:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>c});var s=t(7876),l=t(4232),n=t(9099),r=t(3455),i=t(9966),o=t(8230),d=t.n(o);function c(){let{id:e}=(0,n.useRouter)().query,[a,t]=(0,l.useState)(null),[o,c]=(0,l.useState)([]),[x,h]=(0,l.useState)(!0),[m,u]=(0,l.useState)(!1),[p,b]=(0,l.useState)(""),[f,g]=(0,l.useState)(!1);(0,l.useEffect)(()=>{e&&(async()=>{var a;h(!0),b("");let s=null==(a=(await i.N.auth.getSession()).data.session)?void 0:a.access_token;if(!s){b("Not authenticated"),h(!1);return}let l=await fetch("/api/clients?id=".concat(e),{headers:{Authorization:"Bearer ".concat(s)}});l.ok?t((await l.json()).client):b("Client not found");let n=await fetch("/api/invoices?clientId=".concat(e),{headers:{Authorization:"Bearer ".concat(s)}});n.ok&&c((await n.json()).invoices||[]),h(!1)})()},[e]);let v=e=>{let{name:a,value:s}=e.target;t(e=>({...e,[a]:s}))},j=async e=>{var t;e.preventDefault(),u(!0),b(""),g(!1);let s=null==(t=(await i.N.auth.getSession()).data.session)?void 0:t.access_token;if(!s){b("Not authenticated"),u(!1);return}(await fetch("/api/clients",{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(s)},body:JSON.stringify(a)})).ok?g(!0):b("Failed to save"),u(!1)},N=(null==a?void 0:a.phone)?"https://wa.me/".concat(a.phone.replace(/[^\d]/g,""),"?text=").concat(encodeURIComponent("Hi "+a.name+", ...")):"";return(0,s.jsxs)(r.A,{children:[(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-[#1a1333] via-[#2d1a4d] to-[#ff5f8f] p-4 md:p-8",children:(0,s.jsxs)("div",{className:"max-w-2xl mx-auto bg-white/10 backdrop-blur-xl rounded-2xl shadow-2xl border border-white/10 p-8 mt-8",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold mb-6 text-white",children:"Manage Client"}),x?(0,s.jsx)("div",{className:"text-center text-white/70",children:"Loading..."}):p?(0,s.jsx)("div",{className:"text-center text-red-400",children:p}):a?(0,s.jsxs)("form",{onSubmit:j,className:"space-y-5",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Name"}),(0,s.jsx)("input",{type:"text",name:"name",className:"w-full px-3 py-2 border rounded",value:a.name||"",onChange:v,required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Email"}),(0,s.jsx)("input",{type:"email",name:"email",className:"w-full px-3 py-2 border rounded",value:a.email||"",onChange:v,required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Phone"}),(0,s.jsx)("input",{type:"text",name:"phone",className:"w-full px-3 py-2 border rounded",value:a.phone||"",onChange:v,required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Company"}),(0,s.jsx)("input",{type:"text",name:"company",className:"w-full px-3 py-2 border rounded",value:a.company||"",onChange:v})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Location"}),(0,s.jsx)("input",{type:"text",name:"location",className:"w-full px-3 py-2 border rounded",value:a.location||"",onChange:v})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Notes"}),(0,s.jsx)("textarea",{name:"notes",className:"w-full px-3 py-2 border rounded",value:a.notes||"",onChange:v})]}),p&&(0,s.jsx)("div",{className:"text-red-500 text-sm",children:p}),f&&(0,s.jsx)("div",{className:"text-green-600 text-sm",children:"Saved!"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("button",{type:"submit",className:"bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700",disabled:m,children:m?"Saving...":"Save"}),a.phone&&(0,s.jsx)("a",{href:N,target:"_blank",rel:"noopener noreferrer",className:"bg-green-600 text-white px-6 py-2 rounded hover:bg-green-700",children:"Send WhatsApp"})]})]}):null]})}),(0,s.jsxs)("div",{className:"max-w-2xl mx-auto bg-white rounded-lg shadow p-8 mt-8",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Invoices for this Client"}),0===o.length?(0,s.jsx)("div",{className:"text-center text-gray-500",children:"No invoices found."}):(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,s.jsx)("thead",{className:"bg-gray-100",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Title"}),(0,s.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Amount"}),(0,s.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),(0,s.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Due Date"}),(0,s.jsx)("th",{className:"px-4 py-2"})]})}),(0,s.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:o.map(e=>(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"px-4 py-2 whitespace-nowrap font-semibold",children:e.title}),(0,s.jsxs)("td",{className:"px-4 py-2 whitespace-nowrap",children:["$",e.totalAmount.toFixed(2)]}),(0,s.jsx)("td",{className:"px-4 py-2 whitespace-nowrap",children:(0,s.jsx)("span",{className:"px-2 py-1 rounded text-xs ".concat("Paid"===e.status?"bg-green-100 text-green-700":"Overdue"===e.status?"bg-red-100 text-red-700":"Sent"===e.status?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"),children:e.status})}),(0,s.jsx)("td",{className:"px-4 py-2 whitespace-nowrap",children:new Date(e.dueDate).toLocaleDateString()}),(0,s.jsx)("td",{className:"px-4 py-2 whitespace-nowrap",children:(0,s.jsx)(d(),{href:"/dashboard/crm/invoice/".concat(e.id,"/preview"),className:"bg-gray-200 text-gray-700 px-3 py-1 rounded hover:bg-gray-300 text-xs",children:"View"})})]},e.id))})]})})]})]})}},9099:(e,a,t)=>{e.exports=t(8253)}},e=>{e.O(0,[230,636,593,792],()=>e(e.s=500)),_N_E=e.O()}]);